.\" Automatically generated by Pandoc 3.7.0.1
.\"
.TH "ANIMATION.PERSIST" "3JS" "July 7, 2023" "JavaScript" "JavaScript Reference Manual"
.SH NAME
Animation.persist \- Animation: persist() method
.SH SYNOPSIS
The \f[CR]persist()\f[R] method of the Web Animations API\(cqs
\f[CR]Animation\f[R] interface explicitly persists an animation,
preventing it from being automatically removed when it is replaced by
another animation.
.SH SYNTAX
.IP
.EX
persist()
.EE
.SS Parameters
None.
.SS Return value
None (\f[CR]undefined\f[R]).
.SH EXAMPLES
.SS Using \f[CR]persist()\f[R]
In this example, we have three buttons:
.IP \(bu 2
\(lqAdd persistent animation\(rq and \(lqAdd transient animation\(rq
each add a new transform animation to the red square.
The animations alternate direction: so the first is left to right, the
second is right to left, and so on.
\(lqAdd persistent animation\(rq calls \f[CR]persist()\f[R] on the
animation it creates.
.IP \(bu 2
The third button, \(lqCancel an animation\(rq, cancels the most recently
added animation.
.PP
The example displays a list of all animations that have not been
canceled, in the order they were added, along with each animation\(cqs
\f[CR]replaceState\f[R].
.SS HTML
.IP
.EX
<\f[B]div\f[R] id=\(dqanimation\-target\(dq></\f[B]div\f[R]>
<\f[B]button\f[R] id=\(dqstart\-persistent\(dq>Add persistent animation</\f[B]button\f[R]>
<\f[B]button\f[R] id=\(dqstart\-transient\(dq>Add transient animation</\f[B]button\f[R]>
<\f[B]button\f[R] id=\(dqcancel\(dq>Cancel an animation</\f[B]button\f[R]>
<\f[B]ol\f[R] id=\(dqstack\(dq></\f[B]ol\f[R]>
.EE
.SS CSS
.IP
.EX
div {
  \f[B]width\f[R]: 100px;
  \f[B]height\f[R]: 100px;
  \f[B]background\f[R]: red;
  \f[B]transform\f[R]: translate(100px);
}
.EE
.SS JavaScript
.IP
.EX
\f[B]const\f[R] target = document.getElementById(\(dqanimation\-target\(dq);
\f[B]const\f[R] persistentButton = document.getElementById(\(dqstart\-persistent\(dq);
\f[B]const\f[R] transientButton = document.getElementById(\(dqstart\-transient\(dq);
\f[B]const\f[R] cancelButton = document.getElementById(\(dqcancel\(dq);
persistentButton.addEventListener(\(dqclick\(dq, () \f[B]=>\f[R] startAnimation(\f[B]true\f[R]));
transientButton.addEventListener(\(dqclick\(dq, () \f[B]=>\f[R] startAnimation(\f[B]false\f[R]));
cancelButton.addEventListener(\(dqclick\(dq, cancelTop);
\f[B]const\f[R] stack = [];

\f[B]let\f[R] offset = \-100;

\f[B]function\f[R] startAnimation(persist) {
  offset = \-offset;
  \f[B]const\f[R] animation = target.animate(
    { transform: \(gatranslate(${100 + offset}px)\(ga },
    { duration: 500, fill: \(dqforwards\(dq },
  );
  stack.push(animation);
  \f[B]if\f[R] (persist) {
    animation.persist();
  }
  \f[I]// Add the animation to the displayed stack (implementation not shown)\f[R]
  show(animation, offset);
}

\f[B]function\f[R] cancelTop() {
  stack.pop()?.cancel();
}
.EE
.SS Result
Note that adding a new transient animation will replace any previously
added transient animation.
Those animations will be automatically removed, and their
\f[CR]replaceState\f[R] will be \f[CR]\(dqremoved\(dq\f[R].
However, persistent animations will not be removed.
.PP
Also note that removed animations don\(cqt affect the display; the
position of the \f[CR]<div>\f[R] is determined by the most recent active
or persisted animation.
.SH SEE ALSO
.IP \(bu 2
Web Animations API
.IP \(bu 2
\f[CR]Animation\f[R] for other methods and properties you can use to
control web page animation.
.IP \(bu 2
\f[CR]Animation.replaceState\f[R]
.IP \(bu 2
\f[CR]remove\f[R] event
