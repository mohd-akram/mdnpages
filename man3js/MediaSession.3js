.\" Automatically generated by Pandoc 3.7.0.1
.\"
.TH "MEDIASESSION" "3JS" "February 26, 2025" "JavaScript" "JavaScript Reference Manual"
.SH NAME
MediaSession \- MediaSession
.SH SYNOPSIS
The \f[B]\f[CB]MediaSession\f[B]\f[R] interface of the Media Session API
allows a web page to provide custom behaviors for standard media
playback interactions, and to report metadata that can be sent by the
user agent to the device or operating system for presentation in
standardized user interface elements.
.PP
For example, a smartphone might have a standard panel in its lock screen
that provides controls for media playback and information display.
A browser on the device can use \f[CR]MediaSession\f[R] to make browser
playback controllable from that standard/global user interface.
.SH INSTANCE PROPERTIES
.TP
\f[B]metadata\f[R]
Returns an instance of \f[CR]MediaMetadata\f[R], which contains rich
media metadata for display in a platform UI.
.TP
\f[B]playbackState\f[R]
Indicates whether the current media session is playing.
Valid values are \f[CR]none\f[R], \f[CR]paused\f[R], or
\f[CR]playing\f[R].
.SH INSTANCE METHODS
.TP
\f[B]setActionHandler()\f[R]
Sets an action handler for a media session action, such as play or
pause.
.TP
\f[B]setCameraActive()\f[R]
Indicates to the user agent whether the user\(cqs camera is considered
to be active.
.TP
\f[B]setMicrophoneActive()\f[R]
Indicates to the user agent whether the user\(cqs microphone is
considered to be currently muted.
.TP
\f[B]setPositionState()\f[R]
Sets the current playback position and speed of the media currently
being presented.
.SH EXAMPLES
.SS Setting up action handlers for a music player
The following example creates a new media session and assigns action
handlers to it:
.IP
.EX
\f[B]if\f[R] (\(dqmediaSession\(dq \f[B]in\f[R] navigator) {
  navigator.mediaSession.metadata = \f[B]new\f[R] MediaMetadata({
    title: \(dqUnforgettable\(dq,
    artist: \(dqNat King Cole\(dq,
    album: \(dqThe Ultimate Collection (Remastered)\(dq,
    artwork: [
      {
        src: \(dqhttps://dummyimage.com/96x96\(dq,
        sizes: \(dq96x96\(dq,
        type: \(dqimage/png\(dq,
      },
      {
        src: \(dqhttps://dummyimage.com/128x128\(dq,
        sizes: \(dq128x128\(dq,
        type: \(dqimage/png\(dq,
      },
      {
        src: \(dqhttps://dummyimage.com/192x192\(dq,
        sizes: \(dq192x192\(dq,
        type: \(dqimage/png\(dq,
      },
      {
        src: \(dqhttps://dummyimage.com/256x256\(dq,
        sizes: \(dq256x256\(dq,
        type: \(dqimage/png\(dq,
      },
      {
        src: \(dqhttps://dummyimage.com/384x384\(dq,
        sizes: \(dq384x384\(dq,
        type: \(dqimage/png\(dq,
      },
      {
        src: \(dqhttps://dummyimage.com/512x512\(dq,
        sizes: \(dq512x512\(dq,
        type: \(dqimage/png\(dq,
      },
    ],
  });

  navigator.mediaSession.setActionHandler(\(dqplay\(dq, () \f[B]=>\f[R] {
    \f[I]/* Code excerpted. */\f[R]
  });
  navigator.mediaSession.setActionHandler(\(dqpause\(dq, () \f[B]=>\f[R] {
    \f[I]/* Code excerpted. */\f[R]
  });
  navigator.mediaSession.setActionHandler(\(dqstop\(dq, () \f[B]=>\f[R] {
    \f[I]/* Code excerpted. */\f[R]
  });
  navigator.mediaSession.setActionHandler(\(dqseekbackward\(dq, () \f[B]=>\f[R] {
    \f[I]/* Code excerpted. */\f[R]
  });
  navigator.mediaSession.setActionHandler(\(dqseekforward\(dq, () \f[B]=>\f[R] {
    \f[I]/* Code excerpted. */\f[R]
  });
  navigator.mediaSession.setActionHandler(\(dqseekto\(dq, () \f[B]=>\f[R] {
    \f[I]/* Code excerpted. */\f[R]
  });
  navigator.mediaSession.setActionHandler(\(dqprevioustrack\(dq, () \f[B]=>\f[R] {
    \f[I]/* Code excerpted. */\f[R]
  });
  navigator.mediaSession.setActionHandler(\(dqnexttrack\(dq, () \f[B]=>\f[R] {
    \f[I]/* Code excerpted. */\f[R]
  });
  navigator.mediaSession.setActionHandler(\(dqskipad\(dq, () \f[B]=>\f[R] {
    \f[I]/* Code excerpted. */\f[R]
  });
  navigator.mediaSession.setActionHandler(\(dqtogglecamera\(dq, () \f[B]=>\f[R] {
    \f[I]/* Code excerpted. */\f[R]
  });
  navigator.mediaSession.setActionHandler(\(dqtogglemicrophone\(dq, () \f[B]=>\f[R] {
    \f[I]/* Code excerpted. */\f[R]
  });
  navigator.mediaSession.setActionHandler(\(dqhangup\(dq, () \f[B]=>\f[R] {
    \f[I]/* Code excerpted. */\f[R]
  });
}
.EE
.PP
The following example sets up two functions for playing and pausing,
then uses them as callbacks with the relevant action handlers.
.IP
.EX
\f[B]const\f[R] actionHandlers = [
  \f[I]// play\f[R]
  [
    \(dqplay\(dq,
    \f[B]async\f[R] () \f[B]=>\f[R] {
      \f[I]// play our audio\f[R]
      \f[B]await\f[R] audioEl.play();
      \f[I]// set playback state\f[R]
      navigator.mediaSession.playbackState = \(dqplaying\(dq;
      \f[I]// update our status element\f[R]
      updateStatus(allMeta[index], \(dqAction: play  |  Track is playing\&...\(dq);
    },
  ],
  [
    \(dqpause\(dq,
    () \f[B]=>\f[R] {
      \f[I]// pause out audio\f[R]
      audioEl.pause();
      \f[I]// set playback state\f[R]
      navigator.mediaSession.playbackState = \(dqpaused\(dq;
      \f[I]// update our status element\f[R]
      updateStatus(allMeta[index], \(dqAction: pause  |  Track has been paused\&...\(dq);
    },
  ],
];

\f[B]for\f[R] (\f[B]const\f[R] [action, handler] \f[B]of\f[R] actionHandlers) {
  \f[B]try\f[R] {
    navigator.mediaSession.setActionHandler(action, handler);
  } \f[B]catch\f[R] (error) {
    console.log(\(gaThe media session action \(dq${action}\(dq is not supported yet.\(ga);
  }
}
.EE
.SS Using action handlers to control a slide presentation
The \f[CR]\(dqpreviousslide\(dq\f[R] and \f[CR]\(dqnextslide\(dq\f[R]
action handlers can be used to handle moving forward and backward
through a slide presentation, for example when the user puts their
presentation into a Picture\-in\-Picture window, and presses the
browser\-supplied controls for navigating through slides.
.IP
.EX
\f[B]try\f[R] {
  navigator.mediaSession.setActionHandler(\(dqpreviousslide\(dq, () \f[B]=>\f[R] {
    log(\(aq> User clicked \(dqPrevious Slide\(dq icon.\(aq);
    \f[B]if\f[R] (slideNumber > 1) slideNumber\-\-;
    updateSlide();
  });
} \f[B]catch\f[R] (error) {
  log(\(aqWarning! The \(dqpreviousslide\(dq media session action is not supported.\(aq);
}

\f[B]try\f[R] {
  navigator.mediaSession.setActionHandler(\(dqnextslide\(dq, () \f[B]=>\f[R] {
    log(\(aq> User clicked \(dqNext Slide\(dq icon.\(aq);
    slideNumber++;
    updateSlide();
  });
} \f[B]catch\f[R] (error) {
  log(\(aqWarning! The \(dqnextslide\(dq media session action is not supported.\(aq);
}
.EE
.PP
See \c
.UR https://googlechrome.github.io/samples/media-session/slides.html
Presenting Slides / Media Session Sample
.UE \c
\ for a working example.
