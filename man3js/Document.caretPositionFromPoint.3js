.\" Automatically generated by Pandoc 3.2.1
.\"
.TH "Document.caretPositionFromPoint" "JS" "May 17, 2023" "JavaScript" "JavaScript Reference Manual"
.SH NAME
Document.caretPositionFromPoint \- Document: caretPositionFromPoint()
method
.SH SYNOPSIS
The \f[B]\f[CB]caretPositionFromPoint()\f[B]\f[R] method of the
\f[CR]Document\f[R] interface returns a \f[CR]CaretPosition\f[R] object,
containing the DOM node, along with the caret and caret\[cq]s character
offset within that node.
.SH SYNTAX
.IP
.EX
caretPositionFromPoint(x, y)
.EE
.SS Parameters
.TP
\f[B]x\f[R]
The horizontal coordinate of a point.
.TP
\f[B]y\f[R]
The vertical coordinate of a point.
.SS Return value
A \f[CR]CaretPosition\f[R] object.
.SH EXAMPLES
Click anywhere in the \f[B]Demo\f[R] paragraph below to insert a line
break at the point where you click.
The code for it is below the demo.
.SS Demo
The code below first checks for
\f[CR]document.caretPositionFromPoint\f[R] support, but if the browser
doesn\[cq]t support that, the code then checks for
\f[CR]document.caretRangeFromPoint\f[R], and uses that instead.
.SS JavaScript
.IP
.EX
\f[B]function\f[R] insertBreakAtPoint(e) {
  \f[B]let\f[R] range;
  \f[B]let\f[R] textNode;
  \f[B]let\f[R] offset;

  \f[B]if\f[R] (document.caretPositionFromPoint) {
    range = document.caretPositionFromPoint(e.clientX, e.clientY);
    textNode = range.offsetNode;
    offset = range.offset;
  } \f[B]else\f[R] \f[B]if\f[R] (document.caretRangeFromPoint) {
    \f[I]// Use WebKit\-proprietary fallback method\f[R]
    range = document.caretRangeFromPoint(e.clientX, e.clientY);
    textNode = range.startContainer;
    offset = range.startOffset;
  } \f[B]else\f[R] {
    \f[I]// Neither method is supported, do nothing\f[R]
    \f[B]return\f[R];
  }
  \f[I]// Only split TEXT_NODEs\f[R]
  \f[B]if\f[R] (textNode?.nodeType === 3) {
    \f[B]let\f[R] replacement = textNode.splitText(offset);
    \f[B]let\f[R] br = document.createElement(\[dq]br\[dq]);
    textNode.parentNode.insertBefore(br, replacement);
  }
}

\f[B]let\f[R] paragraphs = document.getElementsByTagName(\[dq]p\[dq]);
\f[B]for\f[R] (\f[B]const\f[R] paragraph \f[B]of\f[R] paragraphs) {
  paragraph.addEventListener(\[dq]click\[dq], insertBreakAtPoint, \f[B]false\f[R]);
}
.EE
.SS HTML
.IP
.EX
<\f[B]p\f[R]>
  Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy
  eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam
  voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita
  kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.
</\f[B]p\f[R]>
.EE
.SH SEE ALSO
.IP \[bu] 2
\f[CR]CaretPosition\f[R]
