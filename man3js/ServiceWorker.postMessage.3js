.\" Automatically generated by Pandoc 3.4
.\"
.TH "ServiceWorker.postMessage" "JS" "July 21, 2024" "JavaScript" "JavaScript Reference Manual"
.SH NAME
ServiceWorker.postMessage \- ServiceWorker: postMessage() method
.SH SYNOPSIS
\f[B]Secure context:\f[R] This feature is available only in secure
contexts (HTTPS).
.PP
\f[B]Note:\f[R] This feature is available in Web Workers.
.PP
The \f[B]\f[CB]postMessage()\f[B]\f[R] method of the
\f[CR]ServiceWorker\f[R] interface sends a message to the worker.
The first parameter is the data to send to the worker.
The data may be any JavaScript object which can be handled by the
structured clone algorithm.
.PP
The service worker can send back information to its clients by using the
\f[CR]postMessage()\f[R] method.
The message will not be sent back to this \f[CR]ServiceWorker\f[R]
object but to the associated \f[CR]ServiceWorkerContainer\f[R] available
via \f[CR]navigator.serviceWorker\f[R].
.SH SYNTAX
.IP
.EX
postMessage(message)
postMessage(message, transfer)
postMessage(message, options)
.EE
.SS Parameters
.TP
\f[B]message\f[R]
The object to deliver to the worker; this will be in the \f[CR]data\f[R]
field in the event delivered to the \f[CR]message\f[R] event.
This may be any JavaScript object handled by the structured clone
algorithm.
.RS
.PP
The \f[CR]message\f[R] parameter is mandatory.
If the data to be passed to the worker is unimportant, \f[CR]null\f[R]
or \f[CR]undefined\f[R] must be passed explicitly.
.RE
.TP
\f[B]transfer\f[R] \f[I](optional)\f[R]
An optional array of transferable objects to transfer ownership of.
The ownership of these objects is given to the destination side and they
are no longer usable on the sending side.
These transferable objects should be attached to the message; otherwise
they would be moved but not actually accessible on the receiving end.
.TP
\f[B]options\f[R] \f[I](optional)\f[R]
An optional object containing the following properties:
.RS
.TP
\f[B]transfer\f[R] \f[I](optional)\f[R]
Has the same meaning as the \f[CR]transfer\f[R] parameter.
.RE
.SS Return value
None (\f[CR]undefined\f[R]).
.SS Exceptions
.TP
\f[B]SyntaxError\f[R]
Thrown if the \f[CR]message\f[R] parameter is not provided.
.SH EXAMPLES
In this example a \f[CR]ServiceWorker\f[R] is created and a message is
immediately sent:
.IP
.EX
navigator.serviceWorker.register(\[dq]service\-worker.js\[dq]);

navigator.serviceWorker.ready.then((registration) \f[B]=>\f[R] {
  registration.active.postMessage(
    \[dq]Test message sent immediately after creation\[dq],
  );
});
.EE
.PP
In order to receive the message, the service worker, in
\f[CR]service\-worker.js\f[R] has to listen to the \f[CR]message\f[R]
event on its global scope.
.IP
.EX
\f[I]// This must be in \[ga]service\-worker.js\[ga]\f[R]
addEventListener(\[dq]message\[dq], (event) \f[B]=>\f[R] {
  console.log(\[ga]Message received: ${event.data}\[ga]);
});
.EE
.PP
Note that the service worker can send back messages to the main thread
using the \f[CR]postMessage()\f[R] method.
To receive it, the main thread needs to listen for a \f[CR]message\f[R]
event on the \f[CR]ServiceWorkerContainer\f[R] object.
.SH SEE ALSO
.IP \[bu] 2
The \f[CR]ServiceWorker\f[R] interface it belongs to.
.IP \[bu] 2
Its counterpart, the \f[CR]postMessage()\f[R] method that a service
worker must use to send a message back to the associated
\f[CR]ServiceWorkerContainer\f[R].
