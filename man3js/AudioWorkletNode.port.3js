.\" Automatically generated by Pandoc 3.4
.\"
.TH "AudioWorkletNode.port" "JS" "July 26, 2024" "JavaScript" "JavaScript Reference Manual"
.SH NAME
AudioWorkletNode.port \- AudioWorkletNode: port property
.SH SYNOPSIS
\f[B]Secure context:\f[R] This feature is available only in secure
contexts (HTTPS).
.PP
The read\-only \f[B]\f[CB]port\f[B]\f[R] property of the
\f[CR]AudioWorkletNode\f[R] interface returns the associated
\f[CR]MessagePort\f[R].
It can be used to communicate between the node and its associated
\f[CR]AudioWorkletProcessor\f[R].
.RS
.PP
\f[B]Note:\f[R] The port at the other end of the channel is available
under the \f[CR]port\f[R] property of the processor.
.RE
.SH VALUE
The \f[CR]MessagePort\f[R] object that is connecting the
\f[CR]AudioWorkletNode\f[R] and its associated
\f[CR]AudioWorkletProcessor\f[R].
.SH EXAMPLES
To demonstrate bidirectional communication capabilities, we\[cq]ll
create an \f[CR]AudioWorkletProcessor\f[R], which will output silence
and respond to ping requests from its \f[CR]AudioWorkletNode\f[R].
.PP
First, we need to define a custom \f[CR]AudioWorkletProcessor\f[R], and
register it.
Note that this should be done in a separate file.
.IP
.EX
\f[I]// ping\-pong\-processor.js\f[R]
\f[B]class\f[R] PingPongProcessor \f[B]extends\f[R] AudioWorkletProcessor {
  constructor(...args) {
    \f[B]super\f[R](...args);
    \f[B]this\f[R].port.onmessage = (e) \f[B]=>\f[R] {
      console.log(e.data);
      \f[B]this\f[R].port.postMessage(\[dq]pong\[dq]);
    };
  }
  process(inputs, outputs, parameters) {
    \f[B]return\f[R] \f[B]true\f[R];
  }
}

registerProcessor(\[dq]ping\-pong\-processor\[dq], PingPongProcessor);
.EE
.PP
Now in our main scripts file we\[cq]ll load the processor, create an
instance of \f[CR]AudioWorkletNode\f[R] passing the name of the
processor, and connect the node to an audio graph.
.IP
.EX
\f[B]const\f[R] audioContext = \f[B]new\f[R] AudioContext();
\f[B]await\f[R] audioContext.audioWorklet.addModule(\[dq]ping\-pong\-processor.js\[dq]);
\f[B]const\f[R] pingPongNode = \f[B]new\f[R] AudioWorkletNode(audioContext, \[dq]ping\-pong\-processor\[dq]);
\f[I]// send the message containing \[aq]ping\[aq] string\f[R]
\f[I]// to the AudioWorkletProcessor from the AudioWorkletNode every second\f[R]
setInterval(() \f[B]=>\f[R] pingPongNode.port.postMessage(\[dq]ping\[dq]), 1000);
pingPongNode.port.onmessage = (e) \f[B]=>\f[R] console.log(e.data);
pingPongNode.connect(audioContext.destination);
.EE
.PP
This will output \f[CR]\[dq]ping\[dq]\f[R] and \f[CR]\[dq]pong\[dq]\f[R]
strings to the console every second.
.SH SEE ALSO
.IP \[bu] 2
Web Audio API
.IP \[bu] 2
Using the Web Audio API
