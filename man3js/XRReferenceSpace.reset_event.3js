.\" Automatically generated by Pandoc 3.4
.\"
.TH "XRReferenceSpace.reset_event" "JS" "July 26, 2024" "JavaScript" "JavaScript Reference Manual"
.SH NAME
XRReferenceSpace.reset_event \- XRReferenceSpace: reset event
.SH SYNOPSIS
\f[B]Secure context:\f[R] This feature is available only in secure
contexts (HTTPS).
.PP
The \f[B]\f[CB]reset\f[B]\f[R] event is sent to an
\f[CR]XRReferenceSpace\f[R] object when a discontinuity is detected in
either the native origin or the effective origin, causing a jump in the
position or orientation of objects oriented using the reference space.
This is common when the user calibrates or recalibrates an XR device, or
if the device automatically changes its origin after losing tracking of
the user, then re\-gaining it.
.PP
In the case of \f[CR]XRBoundedReferenceSpace\f[R] objects, the
\f[CR]reset\f[R] event can also be fired when the
\f[CR]boundsGeometry\f[R] changes.
.PP
In either case, the event is sent before any WebXR animation frames
which make use of the new origin are executed.
.PP
This event is not cancelable.
.SH SYNTAX
Use the event name in methods like \f[CR]addEventListener()\f[R], or set
an event handler property.
.IP
.EX
addEventListener(\[dq]reset\[dq], (event) \f[B]=>\f[R] {});

onreset = (event) \f[B]=>\f[R] {};
.EE
.SH EVENT TYPE
An \f[CR]XRReferenceSpaceEvent\f[R].
Inherits from \f[CR]Event\f[R].
.SH EVENT PROPERTIES
\f[I]In addition to the properties listed below, properties from the
parent interface, \f[CI]Event\f[I], are available.\f[R]
.TP
\f[B]referenceSpace\f[R] \f[I](read\-only)\f[R]
An \f[CR]XRReferenceSpace\f[R] indicating the reference space that
generated the event.
.TP
\f[B]transform\f[R] \f[I](read\-only)\f[R]
An \f[CR]XRRigidTransform\f[R] object indicating the position and
orientation of the specified \f[CR]referenceSpace\f[R] object\[cq]s
native origin after the event, defined relative to the coordinate system
before the event.
.SH DESCRIPTION
The \f[CR]reset\f[R] event indicates that the coordinate system has been
reset or reconfigured by changing the reference space\[cq]s origin,
moving and rotating it as indicated by the event\[cq]s
\f[CR]transform\f[R] property.
The event is sent before any animation frame callbacks are executed to
render the pending frame, to ensure that those callbacks have the
updated coordinate system available.
.PP
There are a number of reasons why a reset might occur.
Most common among them are the following:
.IP \[bu] 2
The user has manually reset the coordinate system, such as by requesting
that the headset recalibrate itself to ensure that the facing direction
and hand controllers are synchronized with the user\[cq]s actual
position and facing.
This is primarily an issue for \f[CR]local\f[R] or
\f[CR]local\-floor\f[R] reference spaces.
.IP \[bu] 2
For a \f[CR]bounded\-floor\f[R] reference space, the coordinate system
can be reset if the user exits the boundaries of the reference space and
enters a new one (such as by crossing from one level to another in a
game, where each level is its own map with its own coordinate system).
.IP \[bu] 2
The tracking system has temporarily lost the user, then regained them,
but not until after they had moved enough to leave the immediate
vicinity of the last\-known position.
Primarily an issue for \f[CR]unbounded\f[R] reference spaces.
.IP \[bu] 2
The user is in an \f[CR]unbounded\f[R] reference space and has moved far
enough from the starting position (the reference space\[cq]s origin)
that floating\-point or other forms of error or drift are problematic.
The coordinate system is thus reset with its new origin at or near the
user\[cq]s current position.
.IP \[bu] 2
The WebXR infrastructure or hardware drivers detected that the device
had temporarily lost tracking, causing the hardware and software to be
out of sync on position and orientation.
.RS
.PP
\f[B]Note:\f[R] A \f[CR]reset\f[R] event will \f[I]not\f[R] occur if the
reference space is able to regain tracking of its previous origin, since
that means the origin has not been forced to be relocated.
This event is only fired when the origin has to be relocated to recover
from the tracking loss.
.RE
.SS Manual resets
If you\[cq]ve spent any time using a VR headset, you\[cq]ve had times
when you\[cq]ve started it up and although you\[cq]re facing straight
ahead, the headset thinks you\[cq]re looking at the sky or the floor; or
times when you point the hand controller straight forward, but it thinks
you\[cq]re pointing it up and to the right somewhere.
When that happens, you typically hold down a button somewhere and it
causes the world to resynchronize to the device\[cq]s current
orientation.
That works by sending a \f[CR]reset\f[R] event to the reference space or
reference spaces that are based on the headset\[cq]s orientation.
.SS Handling discontinuities
You can handle jumps in the viewer\[cq]s position by watching the
Boolean \f[CR]XRPose\f[R] property \f[CR]emulatedPosition\f[R].
If a jump in the viewer\[cq]s position coincides with
\f[CR]emulatedPosition\f[R] toggling from \f[CR]true\f[R] to
\f[CR]false\f[R], the viewer has regained tracking, and that their new
position represents a correction from the previously emulated values.
This is typically the desired behavior if your site or app doesn\[cq]t
simulate motion through the space by expressly changing the position
and/or orientation of the viewer (rather than the user\[cq]s physical
movements being used by the XR device to introduce movement).
.PP
However, if that kind of \[lq]teleportation\[rq] is being used, you
actually want to avoid jumping the user\[cq]s position after tracking
recovery, this can introduce additional and potentially jarring jumping.
Instead of allowing this to happen, you can integrate the
\f[CR]emulatedPosition\f[R] into the teleportation offset calculated
prior to calling \f[CR]getOffsetReferenceSpace()\f[R] to create a new
reference space whose updated effective origin is adjusted by the
distance the viewer\[cq]s position jumped since the previous frame.
This way, the user\[cq]s position only changes once rather than twice.
.SS The effect of discontinuity size
The \f[CR]reset\f[R] event won\[cq]t be fired when the discontinuity is
small enough that the device is able to regain tracking within the same
tracking area.
Nor will be fired at an unbounded reference space as it makes small
adjustments to its native origin over time to maintain the space\[cq]s
stability in the vicinity of the user; only large discontinuities will
trigger a reset.
.SH EXAMPLES
To add a handler for the \f[CR]reset\f[R] event, you can use either of
two approaches.
First, you can use the \f[CR]addEventListener()\f[R] method:
.IP
.EX
viewerRefSpace.addEventListener(\[dq]reset\[dq], (event) \f[B]=>\f[R] {
  \f[I]/* perform reset related tasks */\f[R]
});
.EE
.PP
The second option is to set the \f[CR]XRReferenceSpace\f[R] object\[cq]s
\f[CR]onreset\f[R] event handler property:
.IP
.EX
viewerRefSpace.onreset = (event) \f[B]=>\f[R] {
  \f[I]/* perform reset related tasks */\f[R]
};
.EE
