.\" Automatically generated by Pandoc 3.4
.\"
.TH "Window.beforeinstallprompt_event" "JS" "September 2, 2024" "JavaScript" "JavaScript Reference Manual"
.SH NAME
Window.beforeinstallprompt_event \- Window: beforeinstallprompt event
.SH SYNOPSIS
The \f[B]\f[CB]beforeinstallprompt\f[B]\f[R] event fires when the
browser has detected that a website can be installed as a Progressive
Web App.
.PP
There\[cq]s no guaranteed time this event is fired, but it usually
happens on page load.
.PP
The typical use for this event is when a web app wants to provide its
own in\-app UI inviting the user to install the app, rather than the
generic one provided by the browser.
This enables the app to provide more context about the app, explaining
to the user why they might want to install it.
.PP
In this scenario, the handler for this event will:
.IP \[bu] 2
Keep a reference to the \f[CR]BeforeInstallPromptEvent\f[R] object
that\[cq]s passed into it
.IP \[bu] 2
Reveal its in\-app installation UI (this should be hidden by default,
because not all browsers will support installation).
.PP
When the user uses the in\-app installation UI to install the app, the
in\-app installation UI calls the \f[CR]prompt()\f[R] method of the
retained \f[CR]BeforeInstallPromptEvent\f[R] object to show the
installation prompt.
.SH SYNTAX
Use the event name in methods like \f[CR]addEventListener()\f[R], or set
an event handler property.
.IP
.EX
addEventListener(\[dq]beforeinstallprompt\[dq], (event) \f[B]=>\f[R] {});

onbeforeinstallprompt = (event) \f[B]=>\f[R] {};
.EE
.SH EVENT TYPE
A \f[CR]BeforeInstallPromptEvent\f[R].
Inherits from \f[CR]Event\f[R].
.SH EVENT PROPERTIES
\f[I]Inherits properties from its parent, \f[CI]Event\f[I].\f[R]
.TP
\f[B]BeforeInstallPromptEvent.platforms\f[R] *(read\-only)**(non\-standard)* \f[I](experimental)\f[R]
Returns an array of string items containing the platforms on which the
event was dispatched.
This is provided for user agents that want to present a choice of
versions to the user such as, for example, \[lq]web\[rq] or
\[lq]play\[rq] which would allow the user to choose between a web
version or an Android version.
.TP
\f[B]BeforeInstallPromptEvent.userChoice\f[R] *(read\-only)**(non\-standard)* \f[I](experimental)\f[R]
Returns a \f[CR]Promise\f[R] that resolves to an object describing the
user\[cq]s choice when they were prompted to install the app.
.SH EVENT METHODS
.TP
\f[B]BeforeInstallPromptEvent.prompt()\f[R]\f[I](non\-standard)\f[R] \f[I](experimental)\f[R]
Show a prompt asking the user if they want to install the app.
This method returns a \f[CR]Promise\f[R] that resolves to an object
describing the user\[cq]s choice when they were prompted to install the
app.
.SH EXAMPLES
In the following example an app provides its own install button, which
has an \f[CR]id\f[R] of \f[CR]\[dq]install\[dq]\f[R].
Initially the button is hidden.
.IP
.EX
<\f[B]button\f[R] id=\[dq]install\[dq] hidden>Install</\f[B]button\f[R]>
.EE
.PP
The \f[CR]beforeinstallprompt\f[R] handler:
.IP \[bu] 2
Cancels the event, which prevents the browser displaying its own install
UI on some platforms
.IP \[bu] 2
Assigns the \f[CR]BeforeInstallPromptEvent\f[R] object to a variable, so
it can be used later
.IP \[bu] 2
Reveals the app\[cq]s install button.
.IP
.EX
\f[B]let\f[R] installPrompt = \f[B]null\f[R];
\f[B]const\f[R] installButton = document.querySelector(\[dq]#install\[dq]);

window.addEventListener(\[dq]beforeinstallprompt\[dq], (event) \f[B]=>\f[R] {
  event.preventDefault();
  installPrompt = event;
  installButton.removeAttribute(\[dq]hidden\[dq]);
});
.EE
.PP
When clicked, the app\[cq]s install button:
.IP \[bu] 2
Calls the \f[CR]prompt()\f[R] method of the stored event object, to
trigger the installation prompt.
.IP \[bu] 2
Resets its state by clearing the \f[CR]installPrompt\f[R] variable and
hiding itself again.
.IP
.EX
installButton.addEventListener(\[dq]click\[dq], \f[B]async\f[R] () \f[B]=>\f[R] {
  \f[B]if\f[R] (!installPrompt) {
    \f[B]return\f[R];
  }
  \f[B]const\f[R] result = \f[B]await\f[R] installPrompt.prompt();
  console.log(\[ga]Install prompt was: ${result.outcome}\[ga]);
  installPrompt = \f[B]null\f[R];
  installButton.setAttribute(\[dq]hidden\[dq], \[dq]\[dq]);
});
.EE
.SH SEE ALSO
.IP \[bu] 2
\f[CR]BeforeInstallPromptEvent.prompt\f[R]
.IP \[bu] 2
\f[CR]BeforeInstallPromptEvent\f[R]
