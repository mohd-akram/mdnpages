.\" Automatically generated by Pandoc 3.2.1
.\"
.TH "ReadableStreamBYOBRequest.respondWithNewView" "JS" "April 22, 2024" "JavaScript" "JavaScript Reference Manual"
.SH NAME
ReadableStreamBYOBRequest.respondWithNewView \-
ReadableStreamBYOBRequest: respondWithNewView() method
.SH SYNOPSIS
\f[B]Note:\f[R] This feature is available in Web Workers.
.PP
The \f[B]\f[CB]respondWithNewView()\f[B]\f[R] method of the
\f[CR]ReadableStreamBYOBRequest\f[R] interface specifies a new view that
the consumer of the associated readable byte stream should write to
instead of \f[CR]ReadableStreamBYOBRequest.view\f[R].
.PP
The new view must be a \f[CR]TypedArray\f[R] or a \f[CR]DataView\f[R]
that provides a view onto the same backing memory region as
\f[CR]ReadableStreamBYOBRequest.view\f[R].
After this method is called, the view that was passed into the method
will be transferred and no longer modifiable.
.PP
The method is intended for use cases where an underlying byte source
needs to transfer a \f[CR]byobRequest.view\f[R] internally before
finishing its response.
For example, the source may transfer the BYOB view to a separate worker
thread, and wait for the worker to transfer it back once it has been
filled.
.SH SYNTAX
.IP
.EX
respondWithNewView(view)
.EE
.SS Parameters
.TP
\f[B]view\f[R]
A \f[CR]TypedArray\f[R] or a \f[CR]DataView\f[R] that the consumer of
the associated readable byte stream should write to instead of
\f[CR]ReadableStreamBYOBRequest.view\f[R].
.RS
.PP
This must be a view onto the same backing memory region as
\f[CR]ReadableStreamBYOBRequest.view\f[R] and occupy the same or less
memory.
Specifically, it must be either the view\[cq]s buffer or a transferred
version, must have the same \f[CR]byteOffset\f[R], and a
\f[CR]byteLength\f[R] (number of bytes written) that is less than or
equal to that of the view.
.RE
.SS Return value
None (\f[CR]undefined\f[R]).
.SS Exceptions
.TP
\f[B]TypeError\f[R]
Thrown if the source object is not a
\f[CR]ReadableStreamBYOBRequest\f[R], or there is no associated
controller, or the associated internal array buffer is non\-existent or
detached.
It may also be thrown if the \f[CR]view\f[R] is zero\-length when there
is an active reader, or non\-zero when called on a closed stream.
.TP
\f[B]RangeError\f[R]
Thrown if the new \f[CR]view\f[R] does not match the backing memory
region of \f[CR]ReadableStreamBYOBRequest.view\f[R].
For example, it is not the same buffer (or a transferred version), has a
different \f[CR]byteOffset\f[R], or is larger than the memory available
to the backing view.
.SH EXAMPLES
The view to be transferred must be of the same type as
\f[CR]ReadableStreamBYOBRequest.view\f[R], have the same underlying
buffer and byte offset, and be the same or smaller byteLength.
.PP
For example, we might define the view and respond as shown below:
.IP
.EX
\f[B]const\f[R] v = controller.byobRequest.view;
bytesRead = socket.readInto(v.buffer, v.byteOffset, v.byteLength);
byobRequest.respondWithNewView(
  byobRequest.view.subarray(v.byteOffset, bytesRead),
);
.EE
.SH SEE ALSO
.IP \[bu] 2
Using readable byte stream
