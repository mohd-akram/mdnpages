.\" Automatically generated by Pandoc 3.2.1
.\"
.TH "Document.adoptedStyleSheets" "JS" "July 26, 2024" "JavaScript" "JavaScript Reference Manual"
.SH NAME
Document.adoptedStyleSheets \- Document: adoptedStyleSheets property
.SH SYNOPSIS
The \f[B]\f[CB]adoptedStyleSheets\f[B]\f[R] property of the
\f[CR]Document\f[R] interface is used for setting an array of
constructed stylesheets to be used by the document.
.RS
.PP
\f[B]Note:\f[R] A constructed stylesheet is a stylesheet created
programmatically using the \f[CR]CSSStyleSheet()\f[R] constructor (as
compared to one created by a user\-agent when importing a stylesheet
from a script, imported using \f[CR]<style>\f[R] and
\f[CR]\[at]import\f[R], or linked to via \f[CR]<link>\f[R]).
.RE
.PP
The same constructed stylesheets can also be shared with one or more
\f[CR]ShadowRoot\f[R] instances using the
\f[CR]ShadowRoot.adoptedStyleSheets\f[R] property.
Changing an adopted stylesheet will affect all the objects that adopt
it.
.PP
Stylesheets in the property are evaluated along with the document\[cq]s
other stylesheets using the CSS cascade algorithm.
Where the resolution of rules considers stylesheet order,
\f[CR]adoptedStyleSheets\f[R] are assumed to be ordered after those in
\f[CR]Document.styleSheets\f[R].
.PP
Only stylesheets created using the \f[CR]CSSStyleSheet()\f[R]
constructor within the context of the current \f[CR]Document\f[R] may be
adopted.
.SH VALUE
The value is an array of \f[CR]CSSStyleSheet\f[R] instances that must
have been created using the \f[CR]CSSStyleSheet()\f[R] constructor
within the context of the same \f[CR]Document\f[R].
.PP
If the array needs to be modified, use in\-place mutations like
\f[CR]push()\f[R].
The \f[CR]CSSStyleSheet\f[R] instances themselves can also be modified,
and these changes will apply wherever the stylesheet is adopted.
.PP
In an earlier version of the specification, the array was not
modifiable, so the only way to add new stylesheets was to assign a new
array to \f[CR]adoptedStyleSheets\f[R].
.SS Exceptions
.TP
\f[B]NotAllowedError\f[R] \f[B]DOMException\f[R]
One of the \f[CR]CSSStyleSheet\f[R] instances in the array was not
created using the \f[CR]CSSStyleSheet()\f[R] constructor or was
constructed in a different document than the current document, such as
one in a frame.
.SH EXAMPLES
.SS Adopting a stylesheet
The code below shows a stylesheet being constructed, and then
\f[CR]CSSStyleSheet.replaceSync()\f[R] is called to add a rule to the
sheet.
The stylesheet is then added to an array and assigned to the
\f[CR]adoptedStyleSheets\f[R] property.
.IP
.EX
\f[I]// Create an empty \[dq]constructed\[dq] stylesheet\f[R]
\f[B]const\f[R] sheet = \f[B]new\f[R] CSSStyleSheet();
\f[I]// Apply a rule to the sheet\f[R]
sheet.replaceSync(\[dq]a { color: red; }\[dq]);

\f[I]// Apply the stylesheet to a document\f[R]
document.adoptedStyleSheets = [sheet];
.EE
.PP
We can append a new rule to the stylesheet using
\f[CR]CSSStyleSheet.insertRule()\f[R].
.IP
.EX
sheet.insertRule(\[dq]* { background\-color: blue; }\[dq]);
\f[I]// The document will now have blue background.\f[R]
.EE
.SS Append a new stylesheet
To append a whole new stylesheet to the \f[CR]adoptedStyleSheets\f[R]
property we have to create and assign a new combined array.
This is demonstrated below using spread\-syntax:
.IP
.EX
\f[B]const\f[R] extraSheet = \f[B]new\f[R] CSSStyleSheet();
extraSheet.replaceSync(\[dq]p { color: green; }\[dq]);

\f[I]// Combine the existing sheets and new one\f[R]
document.adoptedStyleSheets = [...document.adoptedStyleSheets, extraSheet];
.EE
.SH SHARING A STYLESHEET WITH A SHADOW DOM
We can share a stylesheet to a shadow root in a similar way.
.IP
.EX
\f[I]// Create an element in the document and then create a shadow root:\f[R]
\f[B]const\f[R] node = document.createElement(\[dq]div\[dq]);
\f[B]const\f[R] shadow = node.attachShadow({ mode: \[dq]open\[dq] });

\f[I]//Adopt the same sheet into the shadow DOM\f[R]
shadow.adoptedStyleSheets = [sheet];
.EE
.SH SEE ALSO
.IP \[bu] 2
\c
.UR https://web.dev/articles/constructable-stylesheets
Constructable Stylesheets
.UE \c
\ (web.dev)
.IP \[bu] 2
Using the Shadow DOM
.IP \[bu] 2
\f[CR]CSSStyleSheet()\f[R] constructor
.IP \[bu] 2
\f[CR]CSSStyleSheet.replaceSync()\f[R]
.IP \[bu] 2
\f[CR]CSSStyleSheet.replace()\f[R]
.IP \[bu] 2
\f[CR]CSSStyleSheet.insertRule()\f[R]
.IP \[bu] 2
\f[CR]CSSStyleSheet.deleteRule()\f[R]
